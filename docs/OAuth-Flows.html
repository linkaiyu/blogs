
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OAuth Flow Cross Reference</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #0078d4;
            text-align: center;
            margin-bottom: 30px;
        }
        .table-section {
            margin-bottom: 30px;
        }
        .cross-reference-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
            font-size: 12px;
        }
        .cross-reference-table th {
            background-color: #0078d4;
            color: white;
            padding: 10px 8px;
            text-align: center;
            border: 1px solid #ddd;
            font-weight: bold;
        }
        .cross-reference-table td {
            border: 1px solid #ddd;
            padding: 8px;
            vertical-align: top;
            max-width: 150px;
        }
        .flow-name {
            background-color: #e3f2fd;
            font-weight: bold;
            text-align: center;
            color: #0078d4;
        }
        .cell-content {
            margin-bottom: 8px;
        }
        .cell-link {
            display: block;
            color: #0078d4;
            text-decoration: none;
            margin-bottom: 4px;
            cursor: pointer;
        }
        .cell-link:hover {
            text-decoration: underline;
        }
        .content-panel {
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #fafafa;
            height: 500px;
            overflow-y: auto;
        }
        .content-panel h2 {
            background-color: #0078d4;
            color: white;
            margin: 0;
            padding: 15px;
            border-radius: 8px 8px 0 0;
        }
        .content-placeholder {
            padding: 20px;
            text-align: center;
            color: #666;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Cross Reference Table Section -->
        <div class="table-section">
            <table class="cross-reference-table">
                <thead>
                    <tr>
                        <th>Flow</th>
                        <th>Diagram</th>
                        <th>Request</th>
                        <th>Response</th>
                        <th>Configuration</th>
                        <th>Sample</th>
                        <th>Package</th>
                    </tr>
                </thead>
                <tbody id="crossReferenceTableBody">
                    <!-- Table content will be populated by JavaScript -->
                </tbody>
            </table>
        </div>

    </div>

    <script>
        // Data structure to hold all field information
        const fieldData = [
            // OIDC Flow
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/v2-protocols-oidc#protocol-flow-sign-in",
                display: "OIDC diagram",
                description: "OIDC diagram for ID token",
                flow: "OIDC",
                application: "Web",
                type: "Diagram"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/v2-protocols-oidc#enable-id-tokens",
                display: "OIDC ID token configuration",
                description: "OIDC ID token configuraton sample, enable ID token",
                flow: "OIDC",
                application: "Web",
                type: "Configuration"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/v2-protocols-oidc#send-the-sign-in-request",
                display: "OIDC ID token request",
                description: "OIDC ID token request sample",
                flow: "OIDC",
                application: "Web",
                type: "Request"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/v2-protocols-oidc#successful-response",
                display: "OIDC ID token response",
                description: "OIDC ID token response sample",
                flow: "OIDC",
                application: "Web",
                type: "Response"
            },

            // Auth code Flow
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/v2-oauth2-auth-code-flow#protocol-details",
                display: "Auth code flow",
                description: "Auth code flow diagram",
                flow: "Auth code",
                application: "SPA, Web, Desktop, Mobile",
                type: "Diagram"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/v2-oauth2-auth-code-flow#request-an-authorization-code",
                display: "Auth code request",
                description: "Auth code flow request",
                flow: "Auth code",
                application: "SPA, Web, Desktop, Mobile",
                type: "Request"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/v2-oauth2-auth-code-flow#successful-response",
                display: "Auth code response",
                description: "Auth code flow response",
                flow: "Auth code",
                application: "SPA, Web, Desktop, Mobile",
                type: "Response"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/v2-oauth2-auth-code-flow#request-an-id-token-as-well-or-hybrid-flow",
                display: "Auth code and ID token request",
                description: "Auth code and ID token flow request",
                flow: "Auth code",
                application: "SPA, Web, Desktop, Mobile",
                type: "Request"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/v2-oauth2-auth-code-flow#successful-response-1",
                display: "Auth code and ID token response",
                description: "Auth code and ID token flow response",
                flow: "Auth code",
                application: "SPA, Web, Desktop, Mobile",
                type: "Response"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/v2-oauth2-auth-code-flow#request-an-access-token-with-a-client_secret",
                display: "access token request",
                description: "access token request",
                flow: "Auth code",
                application: "SPA, Web, Desktop, Mobile",
                type: "Request"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/v2-oauth2-auth-code-flow#successful-response-2",
                display: "access token response",
                description: "access token response",
                flow: "Auth code",
                application: "SPA, Web, Desktop, Mobile",
                type: "Response"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/v2-oauth2-auth-code-flow#refresh-the-access-token",
                display: "refresh access token request",
                description: "refresh access token request",
                flow: "Auth code",
                application: "SPA, Web, Desktop, Mobile",
                type: "Request"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/v2-oauth2-auth-code-flow#successful-response-3",
                display: "refresh access token response",
                description: "refresh access token response",
                flow: "Auth code",
                application: "SPA, Web, Desktop, Mobile",
                type: "Response"
            },
            {
                url: "https://github.com/Azure-Samples/active-directory-aspnetcore-webapp-openidconnect-v2/blob/master/4-WebApp-your-API/4-1-MyOrg/README.md#register-the-client-app-todolistclient-aspnetcore-webapi",
                display: "Web",
                description: "Web Application",
                flow: "Auth code",
                application: "Web",
                type: "Configuration"
            },
            {
                url: "https://github.com/Azure-Samples/ms-identity-dotnet-desktop-tutorial/tree/master/1-Calling-MSGraph/1-1-AzureAD#register-the-client-app-console-interactive-multitarget-v2",
                display: "Desktop app",
                description: "Desktop Application",
                flow: "Auth code",
                application: "Web",
                type: "Configuration"
            },

            // Client credential Flow
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/v2-oauth2-client-creds-grant-flow#protocol-diagram",
                display: "Client credential diagram",
                description: "Client credential diagram",
                flow: "Client credential",
                application: "Daemon",
                type: "Diagram"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/v2-oauth2-client-creds-grant-flow#get-a-token",
                display: "Client credential request",
                description: "Client credential request access token",
                flow: "Client credential",
                application: "Daemon",
                type: "Request"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/v2-oauth2-client-creds-grant-flow#successful-response-1",
                display: "Client credential response",
                description: "Client credential response for access token",
                flow: "Client credential",
                application: "Daemon",
                type: "Response"
            },
            {
                url: "https://github.com/Azure-Samples/active-directory-dotnetcore-daemon-v2",
                display: "Client credential .NET Core app sample",
                description: "Client credential .NET Core application sample",
                flow: "Client credential",
                application: "Daemon",
                type: "Sample"
            },
            {
                url: "https://github.com/Azure-Samples/active-directory-dotnet-daemon-v2",
                display: "Client credential .NET MVC app sample",
                description: "Client credential .NET MVC application sample",
                flow: "Client credential",
                application: "Daemon",
                type: "Sample"
            },
            {
                url: "https://github.com/Azure-Samples/ms-identity-dotnetcore-ca-auth-context-app/blob/main/README.md#step-2-alternative-manual-setup-choose-the-azure-ad-tenant-where-you-want-to-create-your-applications",
                display: "Web",
                description: "Web app configuration",
                flow: "Client credential",
                application: "Web",
                type: "Configuration"
            },
            {
                url: "https://github.com/Azure-Samples/ms-identity-dotnetcore-ca-auth-context-app/blob/main/README.md#step-2-alternative-manual-setup-choose-the-azure-ad-tenant-where-you-want-to-create-your-applications",
                display: "Web",
                description: "Web app",
                flow: "Client credential",
                application: "Web",
                type: "Sample"
            },

            // Device code Flow
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/v2-oauth2-device-code#protocol-diagram",
                display: "Device code flow",
                description: "Device code flow",
                flow: "Device code",
                application: "Daemon",
                type: "Diagram"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/v2-oauth2-device-code#device-authorization-request",
                display: "Device code authorization request",
                description: "Device code flow authorization request",
                flow: "Device code",
                application: "Daemon",
                type: "Request"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/v2-oauth2-device-code#device-authorization-response",
                display: "Device code authorization response",
                description: "Device code flow authorization response",
                flow: "Device code",
                application: "Daemon",
                type: "Response"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/v2-oauth2-device-code#authenticating-the-user",
                display: "Device code user authentication request",
                description: "Device code flow user authentication request",
                flow: "Device code",
                application: "Daemon",
                type: "Request"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/v2-oauth2-device-code#successful-authentication-response",
                display: "Device code user authentication response",
                description: "Device code flow user authentication response",
                flow: "Device code",
                application: "Daemon",
                type: "Response"
            },
            {
                url: "https://github.com/Azure-Samples/ms-identity-dotnet-desktop-tutorial/tree/master/4-DeviceCodeFlow#register-the-client-app-console-devicecodeflow-multitarget-v2",
                display: "Console app",
                description: "Device code flow for Console app registration",
                flow: "Device code",
                application: "Desktop",
                type: "Configuration"
            },
            {
                url: "https://github.com/Azure-Samples/ms-identity-dotnet-desktop-tutorial/tree/master/4-DeviceCodeFlow",
                display: "Desktop app",
                description: "Device code app registration",
                flow: "Device code",
                application: "Desktop",
                type: "Sample"
            },
            {
                url: "https://github.com/azure-samples/active-directory-dotnetcore-devicecodeflow-v2#register-the-client-app-active-directory-dotnet-deviceprofile",
                display: "Browserless (Headless)",
                description: "Browserless (Headless) Application",
                flow: "Device code",
                application: "Browserless",
                type: "Configuration"
            },

            // On-Behalf-Of Flow - from OAuth-Flow.md
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/v2-oauth2-on-behalf-of-flow#protocol-diagram",
                display: "On-Behalf-Of flow",
                description: "On-Behalf-Of flow diagram",
                flow: "On-Behalf-Of",
                application: "Web, Web-API, Node-JS",
                type: "Diagram"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/v2-oauth2-on-behalf-of-flow#middle-tier-access-token-request",
                display: "On-Behalf-Of request",
                description: "On-Behalf-Of request",
                flow: "On-Behalf-Of",
                application: "Web, Web-API, Node-JS",
                type: "Request"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/v2-oauth2-on-behalf-of-flow#middle-tier-access-token-response",
                display: "On-Behalf-Of response",
                description: "On-Behalf-Of response",
                flow: "On-Behalf-Of",
                application: "Web, Web-API, Node-JS",
                type: "Response"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/v2-oauth2-on-behalf-of-flow#obtain-a-saml-token-by-using-an-obo-request-with-a-shared-secret",
                display: "On-Behalf-Of SAML assertion request",
                description: "On-Behalf-Of SAML assertion request",
                flow: "On-Behalf-Of",
                application: "Web, Web-API, Node-JS",
                type: "Request"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/v2-oauth2-on-behalf-of-flow#response-with-saml-assertion",
                display: "On-Behalf-Of SAML assertion response",
                description: "On-Behalf-Of SAML assertion response",
                flow: "On-Behalf-Of",
                application: "Web, Web-API, Node-JS",
                type: "Response"
            },
            {
                url: "https://learn.microsoft.com/azure/active-directory/develop/quickstart-configure-app-expose-web-apis",
                display: "Web API configuration",
                description: "Web API configuration",
                flow: "On-Behalf-Of",
                application: "Web-API",
                type: "Configuration"
            },

            // Implicit grant Flow
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/v2-oauth2-implicit-grant-flow#protocol-diagram",
                display: "Implicit flow diagram",
                description: "Implicit flow diagram",
                flow: "Implicit",
                application: "SPA, Web",
                type: "Diagram"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/v2-oauth2-implicit-grant-flow#send-the-sign-in-request",
                display: "Implicit flow request",
                description: "Implicit flow request",
                flow: "Implicit",
                application: "SPA, Web",
                type: "Request"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/v2-oauth2-implicit-grant-flow#successful-response",
                display: "Implicit flow response",
                description: "Implicit flow response",
                flow: "Implicit",
                application: "SPA, Web",
                type: "Response"
            },

            // Username-password-ROPC Flow
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/v2-oauth-ropc#protocol-diagram",
                display: "ROPC flow diagram",
                description: "ROPC flow diagram",
                flow: "Uid-Pwd-ROPC",
                application: "Console, Daemon",
                type: "Diagram"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/v2-oauth-ropc#authorization-request",
                display: "ROPC flow request",
                description: "ROPC flow request",
                flow: "Uid-Pwd-ROPC",
                application: "Console, Daemon",
                type: "Request"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/v2-oauth-ropc#successful-authentication-response",
                display: "ROPC flow response",
                description: "ROPC flow response",
                flow: "Uid-Pwd-ROPC",
                application: "Console, Daemon",
                type: "Response"
            },

            // Sample data from MSAL-Sample.md
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/sample-v2-code?tabs=apptype#single-page-applications",
                display: "SPA",
                description: "Single-page application (SPA)",
                flow: "Auth code",
                application: "SPA",
                type: "Sample"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/sample-v2-code?tabs=apptype#web-applications",
                display: "Web",
                description: "Web Application",
                flow: "OIDC",
                application: "Web",
                type: "Sample"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/sample-v2-code?tabs=apptype#web-applications",
                display: "Web",
                description: "Web Application",
                flow: "On-Behalf-Of",
                application: "Web",
                type: "Sample"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/sample-v2-code?tabs=apptype#web-applications",
                display: "Web",
                description: "Web Application",
                flow: "Auth code",
                application: "Web",
                type: "Sample"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/sample-v2-code?tabs=apptype#web-api",
                display: "Web API",
                description: "Web API",
                flow: "On-Behalf-Of",
                application: "Web API",
                type: "Sample"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/sample-v2-code?tabs=apptype#web-api",
                display: "Web API",
                description: "Web API",
                flow: "Auth Bearer",
                application: "Web API",
                type: "Sample"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/sample-v2-code?tabs=apptype#desktop",
                display: "Desktop",
                description: "Desktop Application",
                flow: "Auth code",
                application: "Desktop",
                type: "Sample"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/sample-v2-code?tabs=apptype#desktop",
                display: "Desktop",
                description: "Desktop Application",
                flow: "Uid-Pwd-ROPC",
                application: "Desktop",
                type: "Sample"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/sample-v2-code?tabs=apptype#desktop",
                display: "Desktop",
                description: "Desktop Application",
                flow: "Integ Win Auth-IWA",
                application: "Desktop",
                type: "Sample"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/sample-v2-code?tabs=apptype#mobile",
                display: "Mobile",
                description: "Mobile Application",
                flow: "Auth code",
                application: "Mobile",
                type: "Sample"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/sample-v2-code?tabs=apptype#service--daemon",
                display: "Daemon",
                description: "Daemon Application",
                flow: "Client credential",
                application: "Daemon",
                type: "Sample"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/sample-v2-code?tabs=apptype#browserless-headless",
                display: "Browserless (Headless)",
                description: "Browserless (Headless) Application",
                flow: "Device code",
                application: "Browserless",
                type: "Sample"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/sample-v2-code?tabs=apptype#azure-functions-as-web-apis",
                display: "Function App",
                description: "Function app as web API",
                flow: "Auth code",
                application: "Function app",
                type: "Sample"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/sample-v2-code?tabs=apptype#microsoft-teams-applications",
                display: "Teams App",
                description: "Teams app",
                flow: "On-Behalf-Of",
                application: "Teams app",
                type: "Sample"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/sample-v2-code?tabs=apptype#multitenant-saas",
                display: "Multitenant SaaS",
                description: "Multitenant SaaS",
                flow: "OIDC",
                application: "Multitenant SaaS",
                type: "Sample"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/sample-v2-code?tabs=apptype#multitenant-saas",
                display: "Multitenant SaaS",
                description: "Multitenant SaaS",
                flow: "Auth code",
                application: "Multitenant SaaS",
                type: "Sample"
            },

            // Package data from MSAL-Package.md
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/reference-v2-libraries#single-page-application-spa",
                display: "SPA",
                description: "Single-page application (SPA)",
                application: "SPA",
                type: "Package"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/reference-v2-libraries#web-application",
                display: "Web",
                description: "Web Application",
                application: "Web",
                type: "Package"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/reference-v2-libraries#desktop-application",
                display: "Desktop",
                description: "Desktop Application",
                application: "Desktop",
                type: "Package"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/reference-v2-libraries#mobile-application",
                display: "Mobile",
                description: "Mobile Application",
                application: "Mobile",
                type: "Package"
            },
            {
                url: "https://learn.microsoft.com/en-us/entra/identity-platform/reference-v2-libraries#service--daemon",
                display: "Daemon",
                description: "Daemon Application",
                application: "Daemon",
                type: "Package"
            }
        ];

        // Define flow types and types for the table structure
        const flowTypes = [
            "OIDC", 
            "Auth code", 
            "Client credential", 
            "Device code", 
            "Implicit", 
            "On-Behalf-Of", 
            "Uid-Pwd-ROPC", 
            "Integ Win Auth-IWA",
            "Auth Bearer"
        ];
        
        const columnTypes = ["Diagram", "Request", "Response", "Configuration", "Sample", "Package"];

        function populateTable() {
            const tableBody = document.getElementById('crossReferenceTableBody');
            
            flowTypes.forEach(flow => {
                const row = document.createElement('tr');
                
                // Flow name cell
                const flowCell = document.createElement('td');
                flowCell.className = 'flow-name';
                flowCell.textContent = flow;
                row.appendChild(flowCell);
                
                // Type columns
                columnTypes.forEach(type => {
                    const cell = document.createElement('td');
                    let matchingFields = [];
                    
                    if (type === "Package") {
                        // For Package type, match by application with Sample entries for this flow
                        const sampleFieldsForFlow = fieldData.filter(field => 
                            field.flow === flow && field.type === "Sample"
                        );
                        
                        // Get unique applications from sample fields for this flow
                        const flowApplications = new Set();
                        sampleFieldsForFlow.forEach(field => {
                            field.application.split(',').forEach(app => {
                                flowApplications.add(app.trim());
                            });
                        });
                        
                        // Find Package fields that match these applications (and avoid duplicates)
                        const seenPackages = new Set();
                        matchingFields = fieldData.filter(field => {
                            if (field.type !== "Package" || field.flow) return false;
                            
                            const packageKey = field.url + "|" + field.display;
                            if (seenPackages.has(packageKey)) return false;
                            
                            const isMatch = Array.from(flowApplications).some(app => 
                                field.application.split(',').some(pkgApp => 
                                    pkgApp.trim() === app
                                )
                            );
                            
                            if (isMatch) {
                                seenPackages.add(packageKey);
                                return true;
                            }
                            return false;
                        });
                    } else {
                        // For other types, find matching fields for this flow and type
                        matchingFields = fieldData.filter(field => 
                            field.flow === flow && field.type === type
                        );
                    }
                    
                    // Create content for each matching field
                    matchingFields.forEach(field => {
                        const contentDiv = document.createElement('div');
                        contentDiv.className = 'cell-content';
                        
                        const link = document.createElement('a');
                        link.className = 'cell-link';
                        link.textContent = field.display;
                        link.onclick = () => openInContentPanel(field.url);
                        
                        contentDiv.appendChild(link);
                        cell.appendChild(contentDiv);
                    });
                    
                    row.appendChild(cell);
                });
                
                tableBody.appendChild(row);
            });
        }

        function openInContentPanel(url) {
            // Open the URL in a new tab/window instead of iframe due to X-Frame-Options restrictions
            window.open(url, '_blank');
            
            // Update the content panel to show that the link was opened
            const contentContainer = document.getElementById('contentContainer');
            contentContainer.innerHTML = `
                <div class="content-placeholder">
                    <p>Link opened in a new tab/window:</p>
                    <p style="color: #0078d4; font-weight: bold;">${url}</p>
                    <p style="margin-top: 20px; font-size: 14px;">Most documentation sites prevent embedding due to security policies. The link has been opened in a new tab for you.</p>
                </div>
            `;
        }

        // Initialize the table when the page loads
        document.addEventListener('DOMContentLoaded', populateTable);
    </script>
</body>
</html>
